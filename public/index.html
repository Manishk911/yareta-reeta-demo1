<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Reta — Uncovering what makes people exceptional (Demo)</title>
  <style>
    :root { --bg:#0b0f1a; --fg:#fff; --accent:#00ffd1; }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,Segoe UI,Roboto,Inter,Arial}
    main{
      min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;
      text-align:center;padding:3rem 1rem 220px;box-sizing:border-box
    }
    h1{font-size:1.5rem;margin:0}
    p{font-size:1rem;max-width:520px;line-height:1.5;margin:.75rem auto 0;opacity:.9}
    a.btn{
      display:inline-block;margin-top:1rem;background:var(--accent);color:#000;
      padding:.75rem 1.5rem;border-radius:10px;font-weight:700;text-decoration:none
    }

    /* Avatar bubble (left/bottom like your snippet) */
    #heygen-streaming-embed{
      z-index:9999;position:fixed;left:40px;bottom:40px;width:200px;height:200px;
      border-radius:50%;border:2px solid #fff;box-shadow:0 8px 24px rgba(0,0,0,.12);
      overflow:hidden;background:#000;cursor:pointer;
      transform-origin:bottom left;transform:scale(1);
      transition:transform .28s ease,opacity .2s ease,visibility .2s ease,border-radius .28s ease;
      opacity:0;visibility:hidden;
    }
    #heygen-streaming-embed.show{opacity:1;visibility:visible}

    /* Expanded state if the embed posts show/hide */
    #heygen-streaming-embed.expand{border:0;border-radius:8px}
    @media (max-width:539px){
      #heygen-streaming-embed.expand{height:266px;width:96%}
    }
    @media (min-width:540px){
      #heygen-streaming-embed.expand{height:366px;width:calc(366px * 16 / 9)}
    }

    /* Auto: speaking => 2x */
    #heygen-streaming-embed.talking{transform:scale(2)}
    /* Manual: click => 3x (wins if both set) */
    #heygen-streaming-embed.fullsize{transform:scale(3)}

    #heygen-streaming-container,#heygen-streaming-container iframe{
      width:100%;height:100%;display:block;border:0
    }
    @media (prefers-reduced-motion:reduce){#heygen-streaming-embed{transition:none}}
  </style>
</head>
<body>
  <main>
    <h1 id="title"> Meet Reta — Uncovering what makes people exceptional</h1>
    <p>I’m Reta — I detect what makes you exceptional. Let’s start by building your profile in 3 quick questions.</p>
  </main>

  <!-- Optional: override content via URL params ?title=&report=&share= -->
  <script>
    (function(){
      const qs = new URLSearchParams(location.search);
      const t = qs.get('title');  if (t)  document.getElementById('title').textContent = t;
      const r = qs.get('report'); if (r)  document.getElementById('reportLink').href = r;

      // Use ?share=... if provided; otherwise use YOUR exact token (already percent-encoded).
      window.HEYGEN_SHARE_RAW =
        qs.get('share') ||
        'eyJxdWFsaXR5IjoiaGlnaCIsImF2YXRhck5hbWUiOiJLYXR5YV9Qcm9mZXNzaW9uYWxMb29rX3B1%0AYmxpYyIsInByZXZpZXdJbWciOiJodHRwczovL2ZpbGVzMi5oZXlnZW4uYWkvYXZhdGFyL3YzLzM0%0AOGRkZjUwM2M2NTRiOWJiYmI4YmVhOWY5MjEwZWFkXzU1ODcwL3ByZXZpZXdfdGFyZ2V0LndlYnAi%0ALCJuZWVkUmVtb3ZlQmFja2dyb3VuZCI6dHJ1ZSwia25vd2xlZGdlQmFzZUlkIjoiZmU4ODU2MTM2%0AOWY4NGMzZGE1YzRlNWYzZGJjMjE2OWYiLCJ1c2VybmFtZSI6IjYwMGZlYmEyN2E2ZTQ4ODk5ZmUw%0AMjY0N2VhY2Q4MWUxIn0%3D';
      // IMPORTANT: we do NOT re-encode this; we pass it through exactly as-is.
    })();
  </script>

  <!-- Embed + behavior -->
  <script>
    (function () {
      const host = "https://labs.heygen.com";
      const url  = host + "/guest/streaming-embed?share=" + (window.HEYGEN_SHARE_RAW || "") + "&inIFrame=1";

      // Wrapper + container
      const wrap = document.createElement("div");
      wrap.id = "heygen-streaming-embed";

      const container = document.createElement("div");
      container.id = "heygen-streaming-container";

      // Iframe
      const iframe = document.createElement("iframe");
      iframe.src = url;
      iframe.title = "Streaming Embed";
      iframe.allow = "microphone; camera; clipboard-read; clipboard-write; autoplay; encrypted-media;";
      iframe.referrerPolicy = "origin-when-cross-origin";

      // Mount
      container.appendChild(iframe);
      wrap.appendChild(container);
      document.body.appendChild(wrap);

      // Reveal when loaded (fallback so you always see the bubble)
      iframe.addEventListener("load", function(){ wrap.classList.add("show"); });

      // Click → toggle 3x
      document.addEventListener("click", function (e) {
        const w = e.target && e.target.closest ? e.target.closest("#heygen-streaming-embed") : null;
        if (w) w.classList.toggle("fullsize");
      });

      // Handle Heygen "streaming-embed" init/show/hide events (their native messages)
      window.addEventListener("message", function (e) {
        if (e.source !== iframe.contentWindow) return;
        const d = e.data;
        if (d && d.type === "streaming-embed") {
          if (d.action === "init")  wrap.classList.add("show");
          if (d.action === "show")  wrap.classList.add("expand");
          if (d.action === "hide")  wrap.classList.remove("expand");
        }
      });

      // Auto 2x while speaking (robust to event-name variants)
      (function enableTalkingScale(){
        let deb = null;
        function setTalk(v){ wrap.classList.toggle("talking", v); }
        window.addEventListener("message", function (e) {
          if (e.source !== iframe.contentWindow) return;
          let d = e.data;
          if (typeof d === "string") { try { d = JSON.parse(d); } catch {} }
          const raw = (d && (d.type || d.event || d.name || (d.detail && (d.detail.type || d.detail.event)))) || "";
          const t = String(raw).toUpperCase();

          const start = t === "AVATAR_START_TALKING" || t === "TALKING_START" || t === "AVATAR.TALKING_START" || raw === "avatar_start_talking";
          const stop  = t === "AVATAR_STOP_TALKING"  || t === "TALKING_END"   || t === "AVATAR.TALKING_STOP"  || raw === "avatar_stop_talking";
          const tick  = t === "AVATAR_TALKING_MESSAGE" || raw === "avatar_talking_message";

          if (start) setTalk(true);
          else if (stop) setTalk(false);
          else if (tick) { setTalk(true); clearTimeout(deb); deb = setTimeout(function(){ setTalk(false); }, 900); }
        });
      })();
    })();
  </script>
</body>
</html>
